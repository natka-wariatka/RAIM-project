{% extends "base.html" %}

{% block content %}
<div class="card shadow-lg rounded-4">
    <div class="card-header bg-primary text-white">
        <i class="fa-solid fa-robot me-2"></i> Chatbot Assistant
    </div>
    <div class="card-body" style="height: 500px; overflow-y: auto;" id="chatbox">
        <!-- Tu będą wiadomości -->
    </div>
    <div class="card-footer bg-dark">
        <div class="input-group">
            <input type="text" id="userInput" class="form-control" placeholder="Tell me about your symptoms ☺️">
            <button class="btn btn-success" id="sendBtn">
                <i class="fa-solid fa-paper-plane"></i>
            </button>
            <button class="btn btn-warning" id="diagnoseBtn">
                <i class="fa-solid fa-stethoscope"></i> Diagnose
            </button>
        </div>
    </div>
</div>
    <div class="mt-4">
  <label for="specialist-select">Wybierz specjalistę:</label>
  <select id="specialist-select" class="form-control">
    {% for specialist in specialists %}
      <option value="{{ specialist }}">{{ specialist }}</option>
    {% endfor %}
  </select>
  <button id="check-appointments" class="btn btn-primary mt-2">Sprawdź wizyty</button>
</div>

<script>
  document.getElementById("check-appointments").addEventListener("click", () => {
    const selectedSpecialist = document.getElementById("specialist-select").value;
    fetch("/forward-to-appointments", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({specialty: selectedSpecialist})
    })
    .then(response => response.json())
    .then(data => {
      if (data.redirect_url) {
        window.location.href = data.redirect_url;
      } else {
        alert("Coś poszło nie tak");
      }
    });
  });
</script>

{% endblock %}

{% block scripts %}
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
{% endblock %}
